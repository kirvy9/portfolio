# JMeter 성능 테스트

이 디렉토리에는 RealWorld API 애플리케이션의 성능 테스트를 위한 JMeter 테스트 계획과 관련 스크립트가 포함되어 있습니다.

## 필요 사항

- JMeter 5.6.3 이상 설치 ([다운로드 링크](https://jmeter.apache.org/download_jmeter.cgi))
- 테스트 대상 서버 실행 중 (기본: localhost:3000)

## 로컬에서 테스트 실행하기

1. `run-jmeter.bat` 파일을 더블클릭합니다.
2. 첫 실행 시 JMeter 설치 경로를 입력합니다 (예: C:\apache-jmeter-5.6.3).
3. 테스트 모드를 선택합니다:
   - **일반 부하 테스트**: 100명의 가상 사용자, 30초 동안 점진적으로 접속, 5회 반복
   - **스트레스 테스트**: 150명의 가상 사용자, 45초 동안 점진적으로 접속, 3회 반복
   - **스파이크 부하 테스트**: 200명의 가상 사용자, 5초 동안 급격하게 접속, 1회 반복
   - **모든 테스트 실행**: 모든 스레드 그룹 활성화
4. 테스트 결과는 `test-results` 폴더에 저장됩니다.
5. 테스트 완료 후 HTML 보고서를 자동으로 열어볼 수 있습니다.
6. 재차 실행 시 jmeter_path.txt 파일에서 지정된 경로 끝부분과 줄바꿈이 적용되어있습니다. 해당 공백을 지워주셔야만 합니다.

## 테스트 시나리오

현재 테스트 계획은 다음 API 엔드포인트를 테스트합니다:

- **로그인**: 사용자 인증 및 토큰 발급
- **회원가입**: 새 사용자 생성
- **게시글 목록 조회**: 모든 게시글 가져오기
- **게시글 작성**: 인증된 사용자의 새 게시글 작성
- **댓글 작성**: 게시글에 댓글 추가
- **게시글 좋아요/취소**: 좋아요 기능 테스트
- **프로필 조회**: 사용자 프로필 정보 가져오기
- **팔로우/언팔로우**: 사용자 팔로우 기능 테스트

## 테스트 계획 수정하기

1. JMeter GUI를 실행합니다:
2. File > Open 메뉴에서 `realworld.jmx` 파일을 엽니다.
3. 필요에 따라 스레드 그룹, 샘플러, 리스너 등을 수정합니다.
4. 저장 후 `run-jmeter.bat`을 사용하여 테스트를 실행합니다.

## 테스트 결과 분석

테스트 결과는 다음 형식으로 저장됩니다:

- **JTL 파일**: 모든 요청과 응답의 상세 결과 (CSV 형식)
- **로그 파일**: JMeter 실행 로그
- **HTML 보고서**: 시각화된 테스트 결과 (그래프, 표 등)

HTML 보고서에서 중점적으로 볼 항목:
- 응답 시간 (Average, 90% Line, 95% Line)
- 처리량 (Throughput)
- 오류율 (Error %)

## CI/CD 파이프라인 통합

GitLab CI/CD 파이프라인에서는 자동으로 다음 테스트를 실행할 수 있습니다:
- 일반 부하 테스트: main 브랜치에 푸시 시 수동 트리거로 실행
- 스트레스 테스트: 스케줄에 따라 실행 (TEST_TYPE=stress 변수 설정 필요)
- 스파이크 테스트: 스케줄에 따라 실행 (TEST_TYPE=spike 변수 설정 필요)

테스트 결과는 파이프라인 아티팩트로 저장되며, 설정에 따라 GitLab Pages에 HTML 보고서가 게시될 수 있습니다.

## 문제 해결

- **JMeter 경로 재설정이 필요한 경우**: `jmeter_path.txt` 파일을 삭제하고 배치 파일을 다시 실행합니다.
- **테스트 실행 오류**: 로그 파일을 확인하여 오류 원인을 분석합니다.
- **서버 연결 실패**: 테스트 대상 서버가 실행 중인지, 포트가 올바른지 확인합니다.